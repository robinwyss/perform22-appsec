---
spec_version: '1.0'
indicators:
  error_rate: "metricSelector=builtin:service.errors.total.count:merge(\"dt.entity.service\"):avg&entitySelector=type(SERVICE),tag(keptn_project:$PROJECT),tag(keptn_stage:$STAGE),tag(keptn_service:$SERVICE)"
  response_time_p95: "metricSelector=builtin:service.response.time:merge(\"dt.entity.service\"):percentile(95)&entitySelector=type(SERVICE),tag(keptn_project:$PROJECT),tag(keptn_stage:$STAGE),tag(keptn_service:$SERVICE)"
  vuln_critical: "SECPV2;securityProblemSelector=riskLevel(CRITICAL),pgiTags(\"keptn_project:$PROJECT\",\"keptn_stage:$STAGE\",\"keptn_service:$SERVICE\")"
  vuln_high: "SECPV2;securityProblemSelector=riskLevel(HIGH),pgiTags(\"keptn_project:$PROJECT\",\"keptn_stage:$STAGE\",\"keptn_service:$SERVICE\")"
  vuln_medium: "SECPV2;securityProblemSelector=riskLevel(MEDIUM),pgiTags(\"keptn_project:$PROJECT\", \"keptn_stage:$STAGE\",\"keptn_service:$SERVICE\")"
  vuln_low: "SECPV2;securityProblemSelector=riskLevel(LOW),pgiTags(\"keptn_project:$PROJECT\",\"keptn_stage:$STAGE\",\"keptn_service:$SERVICE\")"
